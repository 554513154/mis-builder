<?xml version="1.0" encoding="UTF-8"?>
<openerp>
  <data>

    <template id="report_mis_report_instance">
      <t t-call="report.html_container">
        <t t-foreach="docs" t-as="o">
	  <t t-call="report.internal_layout">
	    <t t-set="matrix" t-value="o._compute_matrix()"/>
            <div class="page">
              <h2><span t-field="o.name" /> - <span t-field="o.company_id.name" /></h2>
              <div class="mis_table">
                <div class="mis_thead">
		  <div class="mis_row">
		    <div class="mis_cell mis_collabel"></div>
		    <t t-foreach="matrix.iter_cols()" t-as="col">
                      <div class="mis_cell mis_collabel">
			<t t-esc="col.description"/>
			<t t-if="col.comment">
			  <br/>
			  <t t-esc="col.comment"/>
			</t>
                      </div>
		      <!-- add empty cells because we have no colspan with css tables -->
		      <t t-foreach="list(col.iter_subcols())[1:]" t-as="subcol">
			<div class="mis_cell mis_collabel"></div>
		      </t>
		    </t>
		  </div>
		  <div class="mis_row">
		    <div class="mis_cell mis_collabel"></div>
		    <t t-foreach="matrix.iter_subcols()" t-as="subcol">
		      <div class="mis_cell mis_collabel">
			<t t-esc="subcol.description"/>
			<t t-if="subcol.comment">
			  <br/>
			  <t t-esc="subcol.comment"/>
			</t>
		      </div>
		    </t>
		  </div>
                </div>
                <div class="mis_tbody">
                  <div t-foreach="matrix.iter_rows()" t-as="row" class="mis_row">
                    <div t-att-style="row.style and row.style.to_css_style() or ''" class="mis_cell mis_rowlabel">
		      <t t-esc="row.description"/>
		      <t t-if="row.comment">
			<br/>
			<t t-esc="row.comment"/>
		      </t>
                    </div>
                    <t t-foreach="row.iter_cells()" t-as="cell">
		      <t t-if="cell">
			<div t-att-style="cell.row.style and cell.row.style.to_css_style() or ''" class="mis_cell mis_amount">
			  <div t-att-style="cell.style and cell.style.to_css_style() or ''">
			    <t t-esc="cell.val_rendered"/>
			  </div>
			</div>
		      </t>
		      <t t-if="not cell">
			<div class="mis_cell mis_amount"></div>
		      </t>
                    </t>
                  </div>
                </div>
              </div>
            </div>
          </t>
	</t>
      </t>
    </template>

  </data>
</openerp>
